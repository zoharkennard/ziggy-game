<!DOCTYPE html>
<html>
<head>
    <title>Ziggy's World Tour</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <style>
        body { margin: 0; display: flex; flex-direction: column; justify-content: center; align-items: center; height: 100vh; background: #ffe6e6; font-family: sans-serif; overflow: hidden; touch-action: manipulation; }
        #game-container { position: relative; width: 95vw; max-width: 600px; aspect-ratio: 3/2; }
        canvas { border: 4px solid #ff4d4d; border-radius: 15px; width: 100%; height: 100%; box-shadow: 0 10px 30px rgba(255, 77, 77, 0.3); background-color: #fff; }
        .ui { position: absolute; top: 15px; left: 20px; font-size: 24px; color: #ff4d4d; font-weight: bold; text-shadow: 1px 1px white; z-index: 10;}
        #location { position: absolute; top: 15px; right: 20px; font-size: 16px; color: #ff4d4d; font-weight: bold; background: rgba(255,255,255,0.8); padding: 5px 12px; border-radius: 20px; z-index: 10; border: 2px solid #ff4d4d; }
        #cheer-bubble { position: absolute; bottom: 80px; left: 80px; background: white; border: 2px solid #ff4d4d; padding: 5px 10px; border-radius: 10px; font-weight: bold; color: #ff4d4d; display: none; z-index: 20; font-size: 14px; }
    </style>
</head>
<body>

    <div id="game-container">
        <div class="ui">Score: <span id="score">0</span></div>
        <div id="location">üìç RISD Campus</div>
        <div id="cheer-bubble">GO GO GO! ‚ù§Ô∏è</div>
        <canvas id="gameCanvas"></canvas>
    </div>

    <script>
        const canvas = document.getElementById("gameCanvas");
        const ctx = canvas.getContext("2d");
        const scoreElement = document.getElementById("score");
        const locationTag = document.getElementById("location");
        const cheerBubble = document.getElementById("cheer-bubble");

        canvas.width = 600;
        canvas.height = 400;

        // --- 1. IMAGES ---
        const playerImg = new Image(); playerImg.src = 'https://i.postimg.cc/c42vC0N1/ziggy_ziggygame_0001.png'; 
        const obstacleImg = new Image(); obstacleImg.src = 'https://i.postimg.cc/25ZXqPS1/pixellab-a-slice-of-cheese-in-pixel-art-1770828928232.png';
        const collectibleImg = new Image(); collectibleImg.src = 'https://i.postimg.cc/ZY6MHtZz/pixellab-a-pixel-art-heart-1770821820174.png'; 
        
        // YOUR PIXEL CHARACTER
        const cheerImg = new Image(); 
        cheerImg.src = 'PASTE_YOUR_PIXEL_SELF_LINK_HERE'; // <--- ADD YOUR LINK HERE

        const bgRISD = new Image(); bgRISD.src = 'https://i.postimg.cc/9XZc9QfF/IMG-5608.jpg';
        const bgJapan = new Image(); bgJapan.src = 'https://i.postimg.cc/gcXnTp2r/IMG-5608.jpg';
        const bgNYC = new Image(); bgNYC.src = 'https://i.postimg.cc/44qX7hGW/IMG-5608.jpg';
        const bgLA = new Image(); bgLA.src = 'https://i.postimg.cc/zGJD8Y8w/IMG-5608.jpg';

        // --- 2. STATE ---
        let score = 0;
        let highScore = localStorage.getItem("ziggyHighScore") || 0;
        let gameSpeed = 5;
        let spawnRate = 90;
        let isGameOver = false;
        let gameFrame = 0;
        let lastCheerScore = -1;
        let showCheer = false;

        const dino = { x: 50, y: 300, width: 60, height: 60, dy: 0, jumpForce: 13, gravity: 0.7, grounded: false, jumps: 0, maxJumps: 2 };
        let gameObjects = [];

        const scenes = [
            { name: "üìç RISD Campus", img: bgRISD, ground: "#7f8c8d", msg: "STUCK IN STUDIO! üé®" },
            { name: "üìç Japan", img: bgJapan, ground: "#cf6a87", msg: "LOST IN SHIBUYA! üå∏" },
            { name: "üìç NYC Night", img: bgNYC, ground: "#16213e", msg: "SUBWAY DELAY! üçé" },
            { name: "üìç Los Angeles", img: bgLA, ground: "#e67e22", msg: "405 TRAFFIC JAM! üå¥" }
        ];

        const cheerMessages = ["YOU GOT THIS! ‚ù§Ô∏è", "GO BABY GO! ‚ú®", "RISD PROUD! üé®", "KEEP JUMPING! üêæ"];

        function getCurrentScene() {
            const index = Math.floor(score / 35) % scenes.length;
            return scenes[index];
        }

        function handleAction() {
            if (isGameOver) { restart(); return; }
            if (dino.grounded || dino.jumps < dino.maxJumps) {
                dino.dy = -dino.jumpForce;
                dino.jumps++;
                dino.grounded = false;
            }
        }

        window.addEventListener("keydown", (e) => { if(e.code === "Space") handleAction(); });
        canvas.addEventListener("touchstart", (e) => { e.preventDefault(); handleAction(); }, {passive: false});

        function spawnGameObject() {
            const size = 45;
            const isObstacle = Math.random() > 0.4; 
            let yPos = canvas.height - size - 40;
            if (!isObstacle) yPos -= 80;
            gameObjects.push({ x: canvas.width, y: yPos, width: size, height: size, type: isObstacle ? 'obstacle' : 'collectible', counted: false });
        }

        function update() {
            if (isGameOver) return;
            dino.dy += dino.gravity;
            dino.y += dino.dy;
            if (dino.y + dino.height > canvas.height - 40) {
                dino.y = canvas.height - 40 - dino.height;
                dino.dy = 0;
                dino.grounded = true;
                dino.jumps = 0;
            }

            // --- CHEER LOGIC ---
            let currentSceneIndex = Math.floor(score / 35);
            if (currentSceneIndex > lastCheerScore && score > 0) {
                triggerCheer();
                lastCheerScore = currentSceneIndex;
                if (gameSpeed < 10) gameSpeed += 0.2;
                if (spawnRate > 50) spawnRate -= 2;
            }

            for (let i = gameObjects.length - 1; i >= 0; i--) {
                let obj = gameObjects[i];
                obj.x -= gameSpeed;
                if (dino.x < obj.x + obj.width - 15 && dino.x + dino.width - 15 > obj.x && dino.y < obj.y + obj.height - 15 && dino.y + dino.height - 15 > obj.y) {
                    if (obj.type === 'obstacle') {
                        isGameOver = true;
                        if (score > highScore) { highScore = score; localStorage.setItem("ziggyHighScore", highScore); }
                    } else if (!obj.counted) {
                        score += 10; obj.counted = true; gameObjects.splice(i, 1);
                        scoreElement.innerText = score;
                    }
                }
                if (obj.x + obj.width < -20) {
                    gameObjects.splice(i, 1);
                    if (obj.type === 'obstacle') { score++; scoreElement.innerText = score; }
                }
            }

            gameFrame++;
            if (gameFrame % Math.floor(spawnRate) === 0) spawnGameObject();
        }

        function triggerCheer() {
            showCheer = true;
            cheerBubble.innerText = cheerMessages[Math.floor(Math.random() * cheerMessages.length)];
            cheerBubble.style.display = "block";
            setTimeout(() => { 
                showCheer = false; 
                cheerBubble.style.display = "none";
            }, 3000);
        }

        function draw() {
            const scene = getCurrentScene();
            ctx.clearRect(0, 0, canvas.width, canvas.height);

            if (scene.img.complete) ctx.drawImage(scene.img, 0, 0, canvas.width, 360); 
            ctx.fillStyle = scene.ground;
            ctx.fillRect(0, canvas.height - 40, canvas.width, 40);

            // Draw Cheer Character
            if (showCheer && cheerImg.complete) {
                ctx.drawImage(cheerImg, 20, canvas.height - 110, 60, 80);
            }

            ctx.drawImage(playerImg, dino.x, dino.y, dino.width, dino.height);
            gameObjects.forEach(obj => {
                ctx.drawImage(obj.type === 'obstacle' ? obstacleImg : collectibleImg, obj.x, obj.y, obj.width, obj.height);
            });

            locationTag.innerText = scene.name;
            ctx.fillStyle = (scene.name === "üìç NYC Night") ? "white" : "#ff4d4d";
            ctx.font = "bold 18px sans-serif";
            ctx.textAlign = "right";
            ctx.fillText("Best: " + highScore, canvas.width - 20, 35);

            if (isGameOver) {
                ctx.fillStyle = "rgba(0,0,0,0.75)";
                ctx.fillRect(0, 0, canvas.width, canvas.height);
                ctx.fillStyle = "white";
                ctx.textAlign = "center";
                ctx.font = "bold 36px sans-serif";
                ctx.fillText(scene.msg, canvas.width/2, 160);
                ctx.font = "20px sans-serif";
                ctx.fillText("Score: " + score, canvas.width/2, 210);
                ctx.fillText("Tap to Restart", canvas.width/2, 260);
            }
            update();
            requestAnimationFrame(draw);
        }

        function restart() {
            score = 0; scoreElement.innerText = 0; gameObjects = [];
            gameSpeed = 5; spawnRate = 90; isGameOver = false; 
            dino.y = 200; dino.dy = 0; dino.jumps = 0; lastCheerScore = -1;
        }
        draw();
    </script>
</body>
</html>
